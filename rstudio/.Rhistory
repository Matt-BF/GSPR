install.packages("iNEXT")
library(iNEXT)
library(ggplot2)
ptus = read.csv("./ptu_presence_absence_for_rarefaction.tsv", sep="\t")
data("ciliates")
out = iNEXT(ptus, datatype="incidence_raw")
typeof(ciliates)
ciliates[1]
typeof(ptus)
ptus
matrix(ptus)
data.frame(ciliates)
library(tidyverse)
t(ptus)
ptus
data.frame(ptus)
typeof(ptus)
t(data.frame(ptus))
ptus = data.frame(ptus)
as.data.frame(t(ptus))
ptus
ptus = read.csv("ptu_presence_absence_for_rarefaction.tsv", sep='\t')
out = iNEXT(ptus,datatype = "incidence_raw")
out = iNEXT(ptus,datatype = "incidence_raw",q=0)
df_formatted <- as.data.frame(ptus)
out = iNEXT(df_formatted,datatype = "incidence_raw",q=0)
ciliates
View(df_formatted)
View(ciliates)
ptus = read_csv('ptu_presence_absence_for_rarefaction.tsv', sep='\t')
ptus = read.csv('ptu_presence_absence_for_rarefaction.tsv', sep = '\t')
ciliates
as.list(ciliates[1])
rownames(ciliates$EtoshaPan)
colnames(ciliates$EtoshaPan)
data(spider)
data(spiders)
install.packages("iNEXT")
library(iNEXT)
data("spider")
spider$Girdled
str(spider)
data(bird)
str(bird)
bird
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t')
str(ptus_ab)
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t', col.names = TRUE)
library(iNEXT)
library(ggplot2)
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t')
head(ptus_ab)
data("bird")
head(bird)
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t')
head(ptus_ab)
help("read.csv")
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t', row.names = 1)
head(ptus_ab)
out = iNEXT(ptus_ab)
ggiNEXT(out)
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t')
out = iNEXT(ptus_ab, endpoint=50000, nboot=100)
out = iNEXT(ptus_ab, endpoint=50000)
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t')
out = iNEXT(ptus_ab, endpoint=50000, nboot = 100)
out = iNEXT(ptus_ab, endpoint=23000, nboot = 100)
out = iNEXT(ptus_ab)
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t')
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t', row.names = 1)
ptus_ab = read.csv('ptu_abundance_per_ecosystem.tsv', sep='\t', row.names = 1)
out = iNEXT(ptus_ab)
ggiNEXT(out)
out = iNEXT(ptus_ab, endpoint=50000, nboot = 100)
ggiNEXT(out)
ggiNEXT(out) +
theme(legend.position = 'right')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(c(19,19,19,19,19,19,19,19,19))
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))
install.packages("ggokabeito")
library(ggokabeito)
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_color_okabe_ito()
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_color_okabe_ito()+
theme_classic()
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
theme_minimal()
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_manual(values=as.vector(scale_colour_okabe_ito()))+
theme_minimal()
scale_colour_okabe_ito()
scale_colour_okabe_ito()$data
scale_colour_okabe_ito()$palette
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_minimal()
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
labs(x="Number of plasmids", y='Number of PTUs')
theme_minimal()
ggiNEXT(out) +
+     theme(legend.position = 'right') +
+     scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
+     scale_colour_okabe_ito()+
+     scale_fill_okabe_ito() +
+     labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
labs(x="Number of plasmids", y='Number of PTUs')
install.packages(vegan)
install.packages("vegan")
ptus = data.frame("ptu_abundance_per_ecosystem.tsv", row.names = 1)
head(ptus)
ptus = read.csv("ptu_abundance_per_ecosystem.tsv", sep='\t', row.names = 1)
head(ptus)
ptus = read.csv("ptu_abundance_per_ecosystem.tsv", sep='\t')
head(ptus)
ptus = ptus[-1]
head(ptus)
t(ptus)
ptus
head(ptus)
ptus = read.csv("ptu_abundance_per_ecosystem.tsv", sep='\t')
head(ptus)
ptus = read.csv("ptu_abundance_per_ecosystem.tsv", sep='\t', row.names = 1)
head(ptus)
colnames(ptus)
t(ptus)
head(t(ptus))
ptus = t(ptus)
head(ptus)
rownames(ptus)
colnames(ptus)
data(varespec)
library(vegan)
data(varespec)
head(varespec)
View(varespec)
View(ptus)
View(ptus)
names(ptus) = NULL
View(ptus)
colnames(ptus)
View(ptus)
ptus = read.csv("ptu_abundance_per_ecosystem.tsv", sep='\t', row.names = 1)
ptus = t(ptus)
rownames(ptus) <- ptus[,1]
View(ptus)
ptus = read.csv("ptu_abundance_per_ecosystem.tsv", sep='\t', row.names = 1)
ptus = t(ptus)
ptus = read.csv("ptu_abundance_per_ecosystem.tsv", sep='\t', row.names = 1)
ptus = read.csv("ptu_abundance_per_ecosystem.tsv", sep='\t')
ptus = ptus[-1]
ptus = t(ptus)
vegdist(ptus)
bray-dist = vegdist(ptus)
bray_dist = vegdist(ptus)
data.frame(bray_dist)
View(varespec)
bray_dist = vegdist(ptus, method = 'jaccard')
bray_dist
heatmap(as.matrix(bray_dist))
ptus = read.csv("ptu_abundance_per_ecosystem.tsv", sep='\t', row.names = 1)
View(ptus)
vegdist(ptus, method = 'jaccard')
vegdist(ptus)
ptus = t(ptus)
vegdist(ptus)
bray_dist = vegdist(ptus)
library(ggplot2)
ggplot(bray_dist)+
geom_tile()
ggplot(as.data.frame(bray_dist))+
geom_title()
geom_tile()
write.csv(bray_dist,'bray.csv')
bray_dist
bray_dist
vegdist(ptus, binary = TRUE)
data(dune)
View(dune)
data(dune.env)
View(dune.env)
dune.ano <- with(dune.env, anosim(dune.dist, Management))
dune.dist <- vegdist(dune)
dune.ano <- with(dune.env, anosim(dune.dist, Management))
plot(dune.ano)
plot(bray_dist)
View(ptus)
ptus_pres = read.csv("ptu_presence_absence_for_rarefaction.tsv", sep='\t')
ptus_pres = t(ptus_pres)
vegdist(ptus_pres, method='jaccard')
View(ptus_pres)
ptus_pres = read.csv("ptu_presence_absence_for_rarefaction.tsv", sep='\t', row.names = 1)
ptus_pres = t(ptus_pres)
vegdist(ptus_pres, method='jaccard')
as.matrix(bray_dist)
ggplot(as.matrix(bray_dist))+
gemo_tile()
ggplot(as.matrix(bray_dist))+
geom_tile()
write.csv(as.matrix(bray_dist), 'bray_dist.csv')
gc()
source("~/phylo_gain.R")
pd.calc(clmat)
pd.calc(clmat)/pd.calc(clmat, tip.subset=tips)
pd.calc(clmat, tip.subset=tips)/pd.calc(clmat)
source("~/phylo_gain.R")
source("~/phylo_gain/phylo_gain.R")
source("~/phylo_gain/phylo_gain.R")
setwd("~/phylo_gain")
source("~/phylo_gain/phylo_gain.R")
source("~/phylo_gain/phylo_gain.R")
source("~/phylo_gain/phylo_gain.R")
print(calc_phylo_gain('pruned_refsoil_tree.nwk','plasmid_leaves.txt'))
print(calc_phylo_gain('pruned_plsdb_tree.nwk','plasmid_leaves.txt'))
print(calc_phylo_gain('pruned_plsdb_tree.nwk','plasmid_leaves.txt'))
print(calc_phylo_gain('pruned_refsoil_tree.nwk','plasmid_leaves.txt'))
print(calc_phylo_gain('pruned_isolates_tree.nwk','plasmid_leaves.txt'))
print(calc_phylo_gain('mob_prots_cdhit.faa.sto.faa.tree','all_soil_plasmids_rescued_mob.txt.fixed'))
library(caper)
calc_phylo_gain <- function(tree, tips) {
tre <- read.tree(tree)
clmat <- clade.matrix(tre)
tips <- readLines(tips)
tipsPD <- pd.calc(clmat, tip.subset = tips)
treePD <- pd.calc(clmat)
paste("TipsPD: ",tipsPD)
paste("treePD: ",treePD)
return (tipsPD/treePD)
}
print(calc_phylo_gain('mob_prots_cdhit.faa.sto.faa.tree','all_soil_plasmids_rescued_mob.txt.fixed'))
library(caper)
calc_phylo_gain <- function(tree, tips) {
tre <- read.tree(tree)
clmat <- clade.matrix(tre)
tips <- readLines(tips)
tipsPD <- pd.calc(clmat, tip.subset = tips)
treePD <- pd.calc(clmat)
paste("TipsPD: ",tipsPD)
paste("treePD: ",treePD)
return (tipsPD/treePD)
}
print(calc_phylo_gain('mob_prots_cdhit.faa.sto.faa.tree','all_soil_plasmids_rescued_mob.txt.fixed'))
source("~/phylo_gain/phylo_gain.R")
source("~/phylo_gain/phylo_gain.R")
source("~/phylo_gain/phylo_gain.R")
source("~/phylo_gain/phylo_gain.R")
setwd("~/soil_grids")
install.packages("geodata")
library(geodata)
gph <- soil_world(var="wrb", depth=5, path=tempdir())
install.packages("terra")
library(geodata)
remotes::install_github("rspatial/terra")
library(geodata)
install.packages("geodata")
library(geodata)
setwd("~/")
source("~/ptu_rarefaction.R")
install.packages("ggokabeito")
source("~/ptu_rarefaction.R")
library(ggokabeito)
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_minimal()
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
options(repr.plot.width = 5, repr.plot.height =2)
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
options(repr.plot.width = 10, repr.plot.height =2)
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
options(repr.plot.width = 5, repr.plot.height =20)
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
labs(x="Number of plasmids", y='Number of PTUs')
options(repr.plot.width = 50, repr.plot.height =20)
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_bw() +
labs(x="Number of plasmids", y='Number of PTUs')
minimal
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
source("~/ptu_rarefaction.R")
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabe_ito()+
scale_fill_okabe_ito() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
library(see)
install.packages("see")
library(see)
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_okabeito()+
scale_fill_okabeito() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_oi()+
scale_fill_oi() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_fill_oi() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_oi()+
scale_fill_oi() +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_oi()+
scale_fill_oi(palette = "black_first") +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_oi(palette = "black_first")+
scale_fill_oi(palette = "black_first") +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
ggiNEXT(out) +
theme(legend.position = 'right') +
scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
scale_colour_oi(palette = "full")+
scale_fill_oi(palette = "full") +
theme_minimal() +
labs(x="Number of plasmids", y='Number of PTUs')
